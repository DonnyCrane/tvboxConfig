port: 7890
socks-port: 1080 # SOCKS5ä»£ç†ç«¯å£ï¼ŒDNSè¯·æ±‚ä¼šä¸­è½¬
redir-port: 3333 # é€æ˜ä»£ç†ç«¯å£
allow-lan: true
mode: Rule
log-level: info # æ—¥å¿—æ˜¾ç¤ºçº§åˆ«ï¼š debug-é—®é¢˜è°ƒè¯•ï¼Œinfo-åŸºæœ¬ä¿¡æ¯
external-controller: 0.0.0.0:9090
secret: route
# é€æ˜ä»£ç†å¼€å¯DNS
dns:
  enable: true
  ipv6: false
  listen: 0.0.0.0:53
  enhanced-mode: redir-host # redir-host or fake-ip
  fake-ip-range: 198.18.0.1/16 # Fake IP addresses pool CIDR
  use-hosts: false # lookup hosts and return IP record
  nameserver:
    - 114.114.114.114
  # æä¾› fallback æ—¶ï¼Œå¦‚æœGEOIPé CN ä¸­å›½æ—¶ä½¿ç”¨ fallback è§£æ
  fallback:
    - 8.8.8.8 # Google DNS over TCP
    - 1.1.1.1 # cloudflare DNS over TCP
    - tls://8.8.8.8:853 # Google DNS over TLS
    - tls://1.1.1.1:853 # cloudflare DNS over TLS
    - https://dns.google/dns-query # Google DNS over HTTPS
    - https://cloudflare-dns.com/dns-query # cloudflare DNS over HTTPS
  # å¼ºåˆ¶DNSè§£æä½¿ç”¨`fallback`é…ç½®
  fallback-filter:
    # true: CNä½¿ç”¨nameserverè§£æï¼ŒéCNä½¿ç”¨fallback
    geoip: true
    # geoipè®¾ç½®ä¸ºfalseæ—¶æœ‰æ•ˆï¼š ä¸åŒ¹é…`ipcidr`åœ°å€æ—¶ä¼šä½¿ç”¨`nameserver`ç»“æœï¼ŒåŒ¹é…`ipcidr`åœ°å€æ—¶ä½¿ç”¨`fallback`ç»“æœã€‚
    ipcidr:
      - 240.0.0.0/4
# DIYç»„ä¿ç•™çš„ä¸ªäººèŠ‚ç‚¹
proxies: []
# é…ç½®è§„åˆ™å‚è€ƒæ–‡æ¡£ï¼š https://github.com/Dreamacro/clash/wiki/configuration
# è®¾ç½®ä»£ç†æä¾›è€…(è¿œç¨‹è®¢é˜…åœ°å€+æœ¬åœ°è®¢é˜…æ–‡ä»¶)
# ä½¿ç”¨CDNé“¾æ¥ï¼š https://ghproxy.com/https://raw.githubusercontent.com/learnhard-cn/free_proxy_ss/main/clash/providers/
# ä½¿ç”¨åŸå§‹é“¾æ¥: https://raw.githubusercontent.com/learnhard-cn/free_proxy_ss/main/clash/providers/
proxy-providers:
  provider_url:
    # å…è´¹è®¢é˜…æºä»£ç†ç»„
    type: http
    url: "https://ghproxy.com/https://raw.githubusercontent.com/learnhard-cn/free_proxy_ss/main/clash/clash.provider.yaml"
    interval: 3600
    path: ./providers/provider_remote.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204
  provider_free:
    # å¢™å†…å¯ç”¨ä»£ç†ç»„
    type: http
    url: "https://ghproxy.com/https://raw.githubusercontent.com/learnhard-cn/free_proxy_ss/main/clash/providers/provider_free.yaml"
    interval: 3600
    path: ./providers/provider_free.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204
  provider_outwall:
    # è¢«å¢™ä»£ç†ç»„
    type: http
    url: "https://ghproxy.com/https://raw.githubusercontent.com/learnhard-cn/free_proxy_ss/main/clash/providers/provider_outwall.yaml"
    interval: 3600
    path: ./providers/provider_outwall.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204
  provider_netflix:
    # è§£é”Netflixä»£ç†ç»„
    type: http
    url: "https://ghproxy.com/https://raw.githubusercontent.com/learnhard-cn/free_proxy_ss/main/clash/providers/provider_netflix.yaml"
    interval: 3600
    path: ./providers/provider_netflix.yaml
    health-check:
      enable: true
      interval: 600
      url: http://www.gstatic.com/generate_204

# ç±»å‹é€‰æ‹© ç®€ä»‹
# select : ç”¨äºé€‰æ‹©ä»£ç†æˆ–ä»£ç†ç»„, å¯ä»¥é€šè¿‡ RESTful API æ¥åˆ‡æ¢ä»£ç†ï¼Œå»ºè®®åœ¨ GUI ä¸­ä½¿ç”¨
# load-balance : ç›¸åŒeTLD+1çš„è¯·æ±‚å°†æ‹¨å·åˆ°åŒä¸€ä¸ªä»£ç†ã€‚
# url-test : é€šè¿‡å¯¹ URL çš„é€Ÿåº¦è¿›è¡ŒåŸºå‡†æµ‹è¯•æ¥é€‰æ‹©å°†ä½¿ç”¨å“ªä¸ªä»£ç†ã€‚
# fallback : æŒ‰ä¼˜å…ˆçº§é€‰æ‹©å¯ç”¨çš„ç­–ç•¥ã€‚é€šè¿‡è®¿é—® URL æ¥æµ‹è¯•å¯ç”¨æ€§ï¼Œå°±åƒè‡ªåŠ¨ url-test ç»„ä¸€æ ·ã€‚
# relay : ä¸­ç»§é“¾æ¥ä»£ç†ã€‚ä»£ç†ä¸åº”åŒ…å«ä¸­ç»§ã€‚ä¸æ”¯æŒ UDPã€‚ æµé‡ï¼šClash <-> http <-> vmess <-> ss1 <-> ss2 <-> Internet 
#  
# æ¨èé€‰æ‹©ï¼š
#   å‘½ä»¤è¡ŒæœåŠ¡å»ºè®®é€‰æ‹© url-test / fallback / load-balance
#   GUIçª—å£ å®˜æ–¹å»ºè®®é€‰æ‹© select ï¼Œå½“ç„¶ä¹Ÿæ¨èä½¿ç”¨url-test è‡ªåŠ¨æ£€æµ‹å¯ç”¨æ€§ã€‚
proxy-groups:
  # ä¿ç•™çš„è‡ªå®šä¹‰èŠ‚ç‚¹
  - name: ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    type: select
    proxies:
      - â™»ï¸ è‡ªåŠ¨é€‰æ‹©
      - å…è´¹CDNæ›´æ–°æº
      - PROXY
      - è¢«å¢™ä»£ç†ç»„
      - é»˜è®¤ä»£ç†ç»„
  - name: â™»ï¸ è‡ªåŠ¨é€‰æ‹©
    type: url-test
    url: http://www.gstatic.com/generate_204
    interval: 300
    tolerance: 50
    proxies:
      - å…è´¹CDNæ›´æ–°æº
      - PROXY
      - è¢«å¢™ä»£ç†ç»„
  - name: å…è´¹CDNæ›´æ–°æº
    type: select # load-balance, select, relay, fallback, url-test
    use: # å¼•å…¥ proxy-provider ä½¿ç”¨ use å…³é”®å­—
      - provider_url  # ä¸ªäººè‡ªå®šä¹‰çš„ä»£ç†æ–‡ä»¶
    url: http://www.gstatic.com/generate_204
    interval: 300
  - name: PROXY
    type: select # load-balance, select, relay, fallback, url-test
    use: # å¼•å…¥ proxy-provider ä½¿ç”¨ use å…³é”®å­—
      - provider_free
    url: http://www.gstatic.com/generate_204
    interval: 300
    # strategy: consistent-hashing # or round-robin  # è´Ÿè½½å‡è¡¡ç­–ç•¥
    proxies:
      - DIRECT
  - name: è¢«å¢™ä»£ç†ç»„
    type: select
    use: # å¼•å…¥ proxy-provider ä½¿ç”¨ use å…³é”®å­—
      - provider_outwall # å¢™å¤–è®¢é˜…æºä»£ç†ç»„
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - DIRECT
  - name: è§£é”Netflixéè‡ªåˆ¶å‰§
    type: select
    use:
      - provider_netflix
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - DIRECT
  - name: ä¸­ç»§ç»„-è§£é”å¥ˆé£
    # ä¸­ç»§ä»£ç†ç»„,ä¸æ”¯æŒUDPåè®®ã€‚çº¿è·¯: clash <-> PROXY <-> è§£é”Netflixéè‡ªåˆ¶å‰§ <-> Internet
    type: relay
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - PROXY
      - è§£é”Netflixéè‡ªåˆ¶å‰§
  - name: ä¸­ç»§ç»„-ä¸¤çº§ä»£ç†
    # ä¸­ç»§ä»£ç†ç»„,ä¸æ”¯æŒUDPåè®®ã€‚çº¿è·¯: clash <-> PROXY <-> è¢«å¢™ä»£ç†ç»„ <-> Internet
    type: relay
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - PROXY
      - è¢«å¢™ä»£ç†ç»„
  - name: ä¸­ç»§ç»„-ä¸‰çº§ä»£ç†
    # ä¸­ç»§ä»£ç†ç»„,ä¸æ”¯æŒUDPåè®®ã€‚çº¿è·¯: clash <-> å…è´¹CDNæ›´æ–°æº <-> PROXY <-> è¢«å¢™ä»£ç†ç»„ <-> Internet
    type: relay
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - å…è´¹CDNæ›´æ–°æº
      - PROXY
      - è¢«å¢™ä»£ç†ç»„
  - name: NETFLIX_PROXY
    type: select
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - å…è´¹CDNæ›´æ–°æº
      - è§£é”Netflixéè‡ªåˆ¶å‰§
      - ä¸­ç»§ç»„-ä¸¤çº§ä»£ç†
      - ä¸­ç»§ç»„-è§£é”å¥ˆé£
      - ä¸­ç»§ç»„-ä¸‰çº§ä»£ç†
      - DIRECT
  - name: Tiktok_PROXY
    type: select
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - å…è´¹CDNæ›´æ–°æº
      - è§£é”Netflixéè‡ªåˆ¶å‰§
      - ä¸­ç»§ç»„-ä¸¤çº§ä»£ç†
      - DIRECT
  - name: Bili_PROXY
    type: select
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - DIRECT
      - å…è´¹CDNæ›´æ–°æº
      - PROXY
      - è§£é”Netflixéè‡ªåˆ¶å‰§
      - ä¸­ç»§ç»„-ä¸¤çº§ä»£ç†
  - name: IQiyi_PROXY
    type: select
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - DIRECT
      - å…è´¹CDNæ›´æ–°æº
      - PROXY
      - è§£é”Netflixéè‡ªåˆ¶å‰§
      - ä¸­ç»§ç»„-ä¸¤çº§ä»£ç†
  - name: é»˜è®¤ä»£ç†ç»„
    type: select
    url: http://www.gstatic.com/generate_204
    interval: 300
    proxies:
      - å…è´¹CDNæ›´æ–°æº
      - PROXY
      - è§£é”Netflixéè‡ªåˆ¶å‰§
      - ä¸­ç»§ç»„-ä¸¤çº§ä»£ç†
      - ä¸­ç»§ç»„-è§£é”å¥ˆé£
      - DIRECT


rule-providers:
  google:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt
    path: ./ruleset/google.yaml
    interval: 86400
  private:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt
    path: ./ruleset/private.yaml
    interval: 86400
  gfw:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt
    path: ./ruleset/gfw.yaml
    interval: 86400
  proxy:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt
    path: ./ruleset/proxy.yaml
    interval: 86400
  reject:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt
    path: ./ruleset/reject.yaml
    interval: 86400
  greatfire:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/greatfire.txt
    path: ./ruleset/greatfire.yaml
    interval: 86400
  tld-not-cn:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt
    path: ./ruleset/tld-not-cn.yaml
    interval: 86400
  telegramcidr:
    type: http
    behavior: ipcidr
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt
    path: ./ruleset/telegramcidr.yaml
    interval: 86400
  cncidr:
    type: http
    behavior: ipcidr
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt
    path: ./ruleset/cncidr.yaml
    interval: 86400
  lancidr:
    type: http
    behavior: ipcidr
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt
    path: ./ruleset/lancidr.yaml
    interval: 86400
  applications:
    type: http
    behavior: classical
    url: https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt
    path: ./ruleset/applications.yaml
    interval: 86400
  video_tiktok:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Video/TikTok.yaml
    path: ./ruleset/Video_TikTok.yaml
    interval: 86400
  video_netflix:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Video/Netflix.yaml
    path: ./ruleset/Video_Netflix.yaml
    interval: 86400
  video_iqiyi:
    type: http
    behavior: domain
    url: https://cdn.jsdelivr.net/gh/DivineEngine/Profiles@master/Clash/RuleSet/StreamingMedia/Video/iQIYI.yaml
    path: ./ruleset/Video_iQIYI.yaml
    interval: 86400

# é»‘åå•æ¨¡å¼ï¼Œå‘½ä¸­è§„åˆ™ä½¿ç”¨ä»£ç†
rules:
  - RULE-SET,applications,DIRECT
  - DOMAIN,clash.razord.top,DIRECT
  - DOMAIN,yacd.haishan.me,DIRECT
  - RULE-SET,private,DIRECT
  - RULE-SET,reject,REJECT
  # > Netflix
  - DOMAIN-SUFFIX,netflix.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflix.net,NETFLIX_PROXY
  - DOMAIN-SUFFIX,nflxext.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,nflximg.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,nflximg.net,NETFLIX_PROXY
  - DOMAIN-SUFFIX,nflxso.net,NETFLIX_PROXY
  - DOMAIN-SUFFIX,nflxvideo.net,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest0.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest1.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest2.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest3.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest4.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest5.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest6.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest7.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest8.com,NETFLIX_PROXY
  - DOMAIN-SUFFIX,netflixdnstest9.com,NETFLIX_PROXY
  # Netflixæµ‹é€Ÿç½‘ç«™
  - DOMAIN-SUFFIX,fast.com,NETFLIX_PROXY
  # - RULE-SET,video_netflix,NETFLIX_PROXY
  # > TikTok
  - PROCESS-NAME,com.ss.android.ugc.trill,Tiktok_PROXY
  - DOMAIN-SUFFIX,byteoversea.com,Tiktok_PROXY
  - DOMAIN-SUFFIX,ibytedtos.com,Tiktok_PROXY
  - DOMAIN-SUFFIX,ipstatp.com,Tiktok_PROXY
  - DOMAIN-SUFFIX,muscdn.com,Tiktok_PROXY
  - DOMAIN-SUFFIX,musical.ly,Tiktok_PROXY
  - DOMAIN-SUFFIX,tiktok.com,Tiktok_PROXY
  - DOMAIN-SUFFIX,tik-tokapi.com,Tiktok_PROXY
  - DOMAIN-SUFFIX,tiktokcdn.com,Tiktok_PROXY
  - DOMAIN-SUFFIX,tiktokv.com,Tiktok_PROXY
  # - RULE-SET,video_tiktok,Tiktok_PROXY
  # > iQIYI
  - DOMAIN-SUFFIX,iq.com,IQiyi_PROXY
  - DOMAIN,intl.iqiyi.com,IQiyi_PROXY
  - DOMAIN,intl-rcd.iqiyi.com,IQiyi_PROXY
  - DOMAIN,intl-subscription.iqiyi.com,IQiyi_PROXY
  # - RULE-SET,video_iqiyi,IQiyi_PROXY
  # > Bilibili
  - PROCESS-NAME,com.bilibili.app.in,Bili_PROXY
  - PROCESS-NAME,tv.danmaku.bili,Bili_PROXY
  - DOMAIN-SUFFIX,acg.tv,Bili_PROXY
  - DOMAIN-SUFFIX,acgvideo.com,Bili_PROXY
  - DOMAIN-SUFFIX,b23.tv,Bili_PROXY
  - DOMAIN-SUFFIX,biliapi.com,Bili_PROXY
  - DOMAIN-SUFFIX,biliapi.net,Bili_PROXY
  - DOMAIN-SUFFIX,bilibili.com,Bili_PROXY
  - DOMAIN-SUFFIX,biligame.com,Bili_PROXY
  - DOMAIN-SUFFIX,biligame.net,Bili_PROXY
  - DOMAIN-SUFFIX,bilivideo.com,Bili_PROXY
  - DOMAIN-SUFFIX,hdslb.com,Bili_PROXY
  - DOMAIN-SUFFIX,im9.com,Bili_PROXY
  - DOMAIN-SUFFIX,smtcdns.net,Bili_PROXY
  #
  - RULE-SET,tld-not-cn,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - RULE-SET,google,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - RULE-SET,gfw,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - RULE-SET,proxy,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - RULE-SET,greatfire,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - RULE-SET,telegramcidr,â™»ï¸ è‡ªåŠ¨é€‰æ‹©
  - GEOIP,CN,DIRECT,no-resolve
  - MATCH,DIRECT
